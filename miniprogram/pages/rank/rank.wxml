<view class="container">
  <!-- Tab 切换 -->
  <view class="tab-bar">
    <view
      class="tab-item {{currentTab === 'week' ? 'active' : ''}}"
      data-tab="week"
      bindtap="onTabChange"
    >
      <text>本周排行</text>
    </view>
    <view
      class="tab-item {{currentTab === 'month' ? 'active' : ''}}"
      data-tab="month"
      bindtap="onTabChange"
    >
      <text>本月排行</text>
    </view>
  </view>

  <view wx:if="{{loading}}" class="skeleton-group">
    <view class="skeleton-card" wx:for="{{[1,2,3,4,5]}}" wx:key="*this">
      <view class="skeleton rank-number" style="margin-right:20rpx"></view>
      <view class="skeleton" style="width:90rpx;height:90rpx;border-radius:12rpx;margin-right:20rpx;flex-shrink:0"></view>
      <view class="skeleton-lines">
        <view class="skeleton skeleton-line skeleton-line-medium"></view>
        <view class="skeleton skeleton-line skeleton-line-short"></view>
      </view>
    </view>
  </view>

  <view wx:else class="fade-in">
    <view wx:if="{{rankList.length > 0}}" class="rank-list">
      <view
        class="rank-item card"
        wx:for="{{rankList}}"
        wx:key="name"
        data-dish-ids="{{item.dishIds}}"
        data-dish-name="{{item.name}}"
        bindtap="onDishTap"
      >
        <view class="rank-number {{index < 3 ? 'top-three' : ''}}">
          <text>{{index + 1}}</text>
        </view>
        <image
          class="rank-dish-image"
          wx:if="{{item.imageFileId}}"
          src="{{item.imageFileId}}"
          mode="aspectFill"
        />
        <view class="rank-dish-image rank-dish-image-placeholder" wx:else>
          <text class="placeholder-text">暂无图片</text>
        </view>
        <view class="rank-info">
          <text class="rank-dish-name">{{item.name}}</text>
          <view class="rank-stats">
            <text class="rank-score">{{item.avgScoreText}}分</text>
            <text class="rank-count">出现{{item.appearCount}}次，共{{item.ratingCount}}人评价</text>
          </view>
        </view>
        <view class="rank-star">
          <star-rating value="{{item.avgScore}}" readonly="{{true}}" size="28" />
          <text class="star-value">{{item.avgScoreText}}</text>
        </view>
      </view>
    </view>
    <empty-state wx:else message="暂无排行数据" />
  </view>
</view>
