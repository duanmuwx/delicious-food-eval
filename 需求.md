# 食堂饭菜评分微信小程序 - 需求文档

## 项目背景
个人兴趣项目，在公司同事间小范围推广使用，给公司食堂的饭菜打分。目标是简洁实用，不做过度设计。

## 用户角色
- **普通用户**：所有同事，微信授权登录即可使用，无需注册
- **管理员**：负责录入每日菜品（初期可以只有一个管理员，即开发者自己）

## 核心功能

### 1. 今日菜品
- 首页展示今天的菜品列表（午餐/晚餐分开展示）
- 每道菜显示：菜名、菜品图片（可选）、当前平均分、评分人数
- 用户点击菜品可进入评分

### 2. 菜品评分
- 用户对每道菜打分：1-5 分（用星星展示）
- 可选填一句简短评价（限制 50 字以内）
- 每人每道菜每天只能评一次，可以修改当天的评分
- 评分后实时更新平均分

### 3. 排行榜
- 本周菜品排行（按平均分排序，展示前 10）
- 本月菜品排行
- 显示菜名、平均分、评分次数

### 4. 菜品管理（管理员）
- 添加当日菜品：菜名、餐次（午餐/晚餐）、日期
- 支持拍照上传菜品图片（可选）
- 可以复用历史菜品（食堂菜品经常重复）
- 删除误添加的菜品

## 页面结构（3 个 Tab）
1. **首页（今日菜品）**：展示今日午餐/晚餐菜品列表，点击可评分
2. **排行榜**：本周/本月菜品排名切换
3. **我的**：个人评分历史、管理员入口

## 技术要求
- 微信小程序原生开发（不使用第三方框架，方便学习小程序原生能力）
- 后端使用微信云开发（云函数 + 云数据库 + 云存储），免去服务器运维
- 数据库集合设计需简洁，避免过度设计

## 数据库设计（云数据库）

### dishes 集合（菜品）
```
{
  _id: string,
  name: string,          // 菜名
  meal: "lunch" | "dinner",  // 餐次
  date: string,          // 日期，格式 "2026-02-06"
  imageFileId: string,   // 云存储图片ID（可选）
  avgScore: number,      // 平均分（冗余字段，方便查询）
  ratingCount: number,   // 评分人数（冗余字段）
  createdBy: string,     // 创建者 openid
  createdAt: Date
}
```

### ratings 集合（评分）
```
{
  _id: string,
  dishId: string,        // 菜品ID
  userId: string,        // 用户 openid
  score: number,         // 1-5 分
  comment: string,       // 简短评价（可选）
  date: string,          // 评分日期
  createdAt: Date,
  updatedAt: Date
}
```

### admins 集合（管理员）
```
{
  _id: string,
  userId: string         // 管理员 openid
}
```

## 非功能要求
- 界面简洁清爽，不需要花哨的动画
- 首次加载要快，数据按天查询避免拉取过多数据
- 评分操作要流畅，给用户即时反馈

## 不做的事情（保持简单）
- 不做用户注册/个人资料编辑
- 不做评论回复/社交互动
- 不做菜品推荐算法
- 不做消息通知/推送
- 不做数据导出/分析报表
